{% load crispy_forms_tags %}

<div class="col-12">
	<div class="card-body">
		<div class="basic-form">
			<form method="post" action="{% url 'updateBranch' branchid %}">
				{% csrf_token %}
				<div class="row">
					<div class="col-4">{{ form.company|as_crispy_field }}</div>
					<div class="col-4">{{ form.name|as_crispy_field }}</div>
					<div class="col-4">{{ form.location|as_crispy_field }}</div>
				</div>
				<div class="row">
					<div class="col-1">
						<button type="submit" value="Update" id="btn-submit" class="btn btn-success">Update Branch</button>
					</div>
				</div>
			</form>
		</div>
	</div>
</div>

<script>
	$(document).ready(function () {

		$("#id_email_address").prop('required',true);

		$('validMsg').text('');

		$("#id_phone_number").keypress(function(event) {
			return /\d/.test(String.fromCharCode(event.keyCode));
		});


		$("#id_location").keypress(function(event) {
			return /\D/.test(String.fromCharCode(event.keyCode));
		});

		$("#id_name").keypress(function(event) {
			return /\D/.test(String.fromCharCode(event.keyCode));
		});

		// var phoneFinalVar;
		// var input = document.querySelector("#id_phone_number");

		// var iti = window.intlTelInput(input, {
		// 	autoPlaceholder: "polite",
		// 	separateDialCode: true,
		// 	initialCountry: 'UG',
		// 	placeholderNumberType: 'MOBILE',
		// 	preferredCountries: ["ug", 'ke', 'tz', 'rw'],
		// 	utilsScript: "utils.js",

		// });

		// var errorMap = ["Invalid number", "Invalid country code", "Too short", "Too long"];

		// $("#id_phone_number").on('input', function(){
		// 	if (input.value.trim()) {
		// 		if (iti.isValidNumber()) {
		// 			$('#validMsg').text('');
		// 			$('#validMsg').text('Valid');
		// 			$('#validMsg').css("color", "green");

		// 			phoneFinalVar = iti.getNumber();
		// 			document.getElementById("btn-submit").disabled = false;

		// 		}
		// 		else {
		// 			var errorCode = iti.getValidationError();
		// 			$('#validMsg').text('');
		// 			$('#validMsg').text(errorMap[errorCode]);
		// 			$('#validMsg').css("color", "red");

		// 			document.getElementById("btn-submit").disabled = true;
		// 		}
		// 	}

		// });
	
});

// function IsEmail(emailInput) {
// 	var regex = /^([a-zA-Z0-9_\.\-\+])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;
// 	if(!regex.test(emailInput)) {
// 		return false;
// 	}else{
// 		return true;
// 	}
// }

// $('#id_email_address').on('input', function () {
// 	document.getElementById('id_email_address').style.borderColor = "";
// 	document.getElementById("btn-submit-branch").disabled = false;
// 	$("#validate_email").hide();
// 	$("#invalid_email").hide();
// 	$("#id_email_address").attr('autocomplete', 'off');

// 	var email_address = $(this).val();

// 	if (email_address == ""){
// 		document.getElementById('id_email_address').style.borderColor = "";
// 		document.getElementById("btn-submit-branch").disabled = false;
// 		$("#validate_email").hide();
// 		$("#invalid_email").hide();
// 	}else{
// 		if(IsEmail(email_address)){
// 			$.ajax({
// 				url: "{% url 'validateEmail' %}",
// 				data: {
// 					'email_address': email_address,
// 				},
// 				dataType: 'json',
// 				success: function (data) {
// 					if (data.is_taken) {
// 						$("#validate_email").show();
// 						document.getElementById('id_email_address').style.borderColor = "red";
// 						document.getElementById("btn-submit-branch").disabled = true;
// 					} 
// 					else {
// 						$("#validate_email").hide();
// 						document.getElementById('id_email_address').style.borderColor = "";
// 						document.getElementById("btn-submit-branch").disabled = false;
// 					}
// 				}
// 			});
// 		}
// 		else{
// 			$("#invalid_email").show();
// 			document.getElementById('id_email_address').style.borderColor = "red";
// 			document.getElementById("btn-submit-branch").disabled = true;
// 		}

// 	}
	
// });

</script>