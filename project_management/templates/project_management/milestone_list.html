{% extends 'base.html' %}

{% load static %}

{% block content %}
<!-- Main wrapper  -->
<div id="main-wrapper">
    <!-- header header  -->
    {% include 'header.html' %}
    <!-- End header header -->
    {% include 'left-nav.html' %}
    <!-- Page wrapper  -->
    <div class="page-wrapper">
        <!-- Bread crumb -->
        <div class="row page-titles">
            <div class="col-md-5 align-self-center">
                <h3 class="text-primary">Milestones</h3>
            </div>
            <div class="col-md-7 align-self-center">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="{% url 'home' %}">Home</a></li>
                    <li class="breadcrumb-item active">Milestones</li>
                </ol>
            </div>
        </div>
        <!-- End Bread crumb -->
        <!-- Container fluid  -->
        <div class="container-fluid">
            <!-- Start Page Content -->
            <div class="row">
                <div class="col-lg-12">
                    <div class="card">
                        <div class="card-title">
                            <div class="row">
                                <div class="col-10">
                                    <h4 class="card-title">Milestones</h4>
                                </div>

                                <div class="col-2">
                                    <button id="" class="btn btn-info pull-right" onclick="functAddMilestone();">
                                        <i class="fa fa-fw fa-lg fa-plus"></i>Add Milestone
                                    </button>
                                </div>
                            </div>
                            <br />
                        </div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table table-hover" id="table_priorities">
                                    <thead>
                                        <tr>
                                            <th>Name</th>
                                            <th>Project</th>
                                            <th>Start Date</th>
                                            <th>End Date</th>
                                            <th>Status</th>
                                        </tr>
                                    </thead>

                                    <tbody>
                                        {% for milestone in milestones %}
                                        <tr>
                                            <td><a href="{% url 'milestone_details' milestone.id %}">{{ milestone.name }}</a></td>
                                            <td>{{ milestone.project }}</td>
                                            <td>{{ milestone.startdate }}</td>
                                            <td>{{ milestone.enddate }}</td>
                                            <td>{{ milestone.status }}</td>
                                        </tr>
                                        {% empty %}
                                        <tr>
                                            <td colspan="4">No milestones currently. <a href="{% url 'new_milestone' %}">Add the first milestone</a>.</td>
                                          </tr>
                                        {% endfor %}

                                    </tbody>
                                </table>
                                
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            {% include 'footer.html' %}
            <!-- End PAge Content -->
        </div>
        <!-- End Container fluid  -->

        <script>
            function functAddMilestone(){
                urldata = "{% url 'addMilestone' %}";
                
                $.ajax({
                    type: 'GET',
                    cache: false,
                    data: {},
                    url: urldata,
                    success: function (resp) {
                        $.confirm({
                            title: '<h3>Add Milestone</h3>',
                            content: '' + resp,
                            type: 'blue',
                            theme: 'material',
                            typeAnimated: true,
                            boxWidth: '60%',
                            useBootstrap: false,
                            closeIcon: true,
                            buttons: {
                                close: {
                                    text: 'Close',
                                    btnClass: 'btn-gray close-dialog',
                                    action: function () {
                                    }
                                }
                            }
                        });
                    }
                });
        
                
            }
        </script>
    </div>
    <!-- End Page wrapper  -->
</div>
{% endblock %}

